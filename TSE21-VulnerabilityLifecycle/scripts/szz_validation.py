import csv
import pandas as pd
from sklearn.metrics import cohen_kappa_score


in_filepath = "../data/szz_validation.csv"
df = pd.read_csv(in_filepath, keep_default_na=False, dtype={
    "inspector_1": "Int64",
    "inspector_2": "Int64",
    "inspector_3": "Int64",
    "final_outcome": "Int64"
})
num_cves = len(df)
print(df)

# Percentage of "Correct" of Final Outcomes 
final_outcome_sum = df["final_outcome"].sum()
print("Times SZZ was Correct (Post-Discussion): {}/{} ({}%)".format(final_outcome_sum, num_cves, round(final_outcome_sum / num_cves, 3)))

# Compute Agreement (Cohen's kappa)
kappa = cohen_kappa_score(list(df["inspector_1"]), list(df["inspector_2"]))
print("Inspectors Agreement (Cohen's kappa): {}".format(round(kappa, 3)))
